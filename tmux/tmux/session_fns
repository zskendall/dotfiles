#!/bin/bash

# Basic split pattern:
# +----------------------------------+
# |                |                 |
# |                |                 |
# |                |                 |
# |                |-----------------|
# |                |                 |
# |                |                 |
# |                |                 |
# +----------------------------------+
function default_split() {
  echo $SPLIT
  tmux a -t $SESSION \; \
    split-window -h \; \
    select-pane -t $SPLIT \; \
    split-window \; \
    detach
}

# Creates a configured tmux session
# @arg 1: the session name
# @arg 2: the top side pane
# @arg 3: the client name
# @arg 4: whether to set up multiple panes
function create_session() {
  SESSION=$1

  tmux new -s $SESSION -d \; \
    rename-window "main" \; \

  SPLIT=$2
  default_split

  # If at work, configure the panes.
  if [ "$SESSION" = "îŸ®" ]; then
    . ~/.tmux_work $SPLIT $4 $3;
  else
    tmux a -t $SESSION \; \
      select-pane -t $SPLIT \; \
      send-keys -t $SPLIT "tmux clock-mode" C-m \; \
      send-keys -t $(( $SPLIT + 1)) "cd ~/dotfiles" C-m \; \
      send-keys -t $(( $SPLIT + 1)) "vim ." C-m \; \
      detach

    sleep 1;

    tmux a -t $SESSION \; \
      select-pane -t $(( 2 - $SPLIT * 2 ))
  fi
}
